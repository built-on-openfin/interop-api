import{r as i,h as t}from"./p-53c3f125.js";const s=class{constructor(t){i(this,t),this.showContextGroupList=!1,this.contextGroupId=void 0,this.iconColor=null,this.iconId=null,this.availableContextGroups=[],this.bindViews=!0,this.bindSelf=!0,this.unselectedColor="#ffffff",this.listDelay=500,this.showListOnClick=!0,this.unselectedText="No Context Group Selected"+(this.showListOnClick?". Click To Join.":""),this.selectedText="Current Context Is {0}"+(this.showListOnClick?". Click To Switch/Leave.":""),this.joinText="Switch to {0} Context Group",this.leaveText="Leave {0} Context Group",this.isQueryStringEnabled=!1}async joinContextGroup(i,t){if(void 0!==fin){if(!0===this.bindViews&&!0===fin.me.isWindow)if(void 0===t){let t=await fin.me.getCurrentViews();for(let s=0;s<t.length;s++)await fin.me.interop.joinContextGroup(i,t[s].identity)}else await fin.me.interop.joinContextGroup(i,t);this.bindSelf&&await fin.me.interop.joinContextGroup(i,fin.me.identity)}}async leaveContextGroup(i){if(void 0!==fin){if(!0===this.bindViews&&!0===fin.me.isWindow)if(void 0===i){let i=await fin.me.getCurrentViews();for(let t=0;t<i.length;t++)await fin.me.interop.removeFromContextGroup(i[t].identity)}else await fin.me.interop.removeFromContextGroup(i);this.bindSelf&&await fin.me.interop.removeFromContextGroup(fin.me.identity)}}async saveSelectedContextGroup(i){!1===this.bindSelf&&await fin.me.updateOptions({customData:{selectedContextGroup:i}})}async updateContextGroup(i,t,s=!0){let e=this.availableContextGroups.find((t=>t.id===i));if(null!=e){if(this.contextGroupId===i&&s)this.contextGroupId=void 0,this.iconColor=this.unselectedColor,this.iconId=void 0,await this.leaveContextGroup(t);else{let s=void 0===this.contextGroupId;this.iconColor=e.color,this.iconId=e.id,this.contextGroupId=i,s?await this.joinContextGroup(i):await this.joinContextGroup(i,t)}await this.saveSelectedContextGroup(this.contextGroupId),this.showContextGroupList=!1}}showContextList(){void 0!==this.showListId&&clearTimeout(this.showListId),this.showListId=setTimeout((()=>{this.showContextGroupList=!0,this.showListId=void 0}),this.listDelay)}hideContextList(){this.showContextGroupList=!1}getContextGroupTooltip(i,t=!1){let s=i.charAt(0).toUpperCase()+i.slice(1);return t?this.selectedText.replace("{0}",s):i===this.contextGroupId?this.leaveText.replace("{0}",s):this.joinText.replace("{0}",s)}async setupContextPicker(){if(void 0!==fin){if(this.bindViews&&!0===fin.me.isWindow&&(await fin.Window.getCurrent()).on("view-attached",(async i=>{if(console.log("Attached View: ",i),void 0!==this.contextGroupId)setTimeout((async()=>{await this.updateContextGroup(this.contextGroupId,i.viewIdentity,!1)}),1e3);else{let t=fin.View.wrapSync(i.viewIdentity),s=await t.getOptions();void 0!==s.interop&&void 0!==s.interop.currentContextGroup&&await this.updateContextGroup(s.interop.currentContextGroup,i.viewIdentity)}})),(await fin.me.interop.getContextGroups()).forEach((i=>{this.availableContextGroups.push({id:i.id,color:i.displayMetadata.color})})),this.isQueryStringEnabled){const i=new URLSearchParams(window.location.search).get("contextGroupId");null!=i&&await this.updateContextGroup(i)}if(void 0===this.contextGroupId){let i,t=await fin.me.getOptions();void 0!==t.interop&&void 0!==t.interop.currentContextGroup?i=t.interop.currentContextGroup:!1===this.bindSelf&&void 0!==t.customData&&void 0!==t.customData.selectedContextGroup&&(i=t.customData.selectedContextGroup),await this.updateContextGroup(i)}}}componentWillLoad(){this.setupContextPicker().then((()=>{}))}render(){return this.showContextGroupList?t("div",{id:"available-context",onMouseLeave:this.hideContextList.bind(this)}," ",this.availableContextGroups.map((i=>t("span",{title:this.getContextGroupTooltip(i.id),class:"fade-in",style:{padding:"0px 5px",color:i.color,cursor:"pointer"},onClick:()=>this.updateContextGroup(i.id)},"⬤")))):void 0===this.contextGroupId?t("div",null,t("span",this.showListOnClick?{onClick:this.showContextList.bind(this),title:this.unselectedText,style:{padding:"0px 5px",color:`${this.unselectedColor}`}}:{onMouseEnter:this.showContextList.bind(this),title:this.unselectedText,style:{padding:"0px 5px",color:`${this.unselectedColor}`}},"⬤")):t("div",{id:"selected-context"},t("span",this.showListOnClick?{onClick:this.showContextList.bind(this),title:this.getContextGroupTooltip(this.contextGroupId,!0),style:{padding:"0px 5px",color:`${this.iconColor}`}}:{onMouseEnter:this.showContextList.bind(this),title:this.getContextGroupTooltip(this.contextGroupId,!0),style:{padding:"0px 5px",color:`${this.iconColor}`}},"⬤"))}};s.style=":host{display:block}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.fade-in{animation:fadeIn ease 1s}";export{s as fin_context_group_picker}