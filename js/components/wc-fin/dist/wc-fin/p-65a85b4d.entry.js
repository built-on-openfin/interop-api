import{r as t,h as i}from"./p-d49ebc9d.js";const e=":host{display:block}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.fade-in{animation:fadeIn ease 1s}";const s=window["fin"];const n=class{constructor(i){t(this,i);this.iconColor=null;this.iconId=null;this.availableContextGroups=[];this.showContextGroupList=false;this.contextGroupId=undefined;this.bindViews=true;this.bindSelf=true;this.unselectedColor="#ffffff";this.listDelay=500;this.showListOnClick=true;this.unselectedText="No Context Group Selected"+(this.showListOnClick?". Click To Join.":"");this.selectedText="Current Context Is {0}"+(this.showListOnClick?". Click To Switch/Leave.":"");this.joinText="Switch to {0} Context Group";this.leaveText="Leave {0} Context Group";this.isQueryStringEnabled=false}async joinContextGroup(t,i){if(s!==undefined){if(this.bindViews===true&&s.me.isWindow===true){if(i===undefined){let i=await s.me.getCurrentViews();for(let e=0;e<i.length;e++){await s.me.interop.joinContextGroup(t,i[e].identity)}}else{await s.me.interop.joinContextGroup(t,i)}}if(this.bindSelf){await s.me.interop.joinContextGroup(t,s.me.identity)}}}async leaveContextGroup(t){if(s!==undefined){if(this.bindViews===true&&s.me.isWindow===true){if(t===undefined){let t=await s.me.getCurrentViews();for(let i=0;i<t.length;i++){await s.me.interop.removeFromContextGroup(t[i].identity)}}else{await s.me.interop.removeFromContextGroup(t)}}if(this.bindSelf){await s.me.interop.removeFromContextGroup(s.me.identity)}}}async saveSelectedContextGroup(t){if(this.bindSelf===false){await s.me.updateOptions({customData:{selectedContextGroup:t}})}}async updateContextGroup(t,i,e=true){let s=this.availableContextGroups.find((i=>i.id===t));if(s!==null&&s!==undefined){if(this.contextGroupId===t&&e){this.contextGroupId=undefined;this.iconColor=this.unselectedColor;this.iconId=undefined;await this.leaveContextGroup(i)}else{let e=this.contextGroupId===undefined;this.iconColor=s.color;this.iconId=s.id;this.contextGroupId=t;if(e){await this.joinContextGroup(t)}else{await this.joinContextGroup(t,i)}}await this.saveSelectedContextGroup(this.contextGroupId);this.showContextGroupList=false}}showContextList(){if(this.showListId!==undefined){clearTimeout(this.showListId)}this.showListId=setTimeout((()=>{this.showContextGroupList=true;this.showListId=undefined}),this.listDelay)}hideContextList(){this.showContextGroupList=false}getContextGroupTooltip(t,i=false){let e=t.charAt(0).toUpperCase()+t.slice(1);if(i){return this.selectedText.replace("{0}",e)}if(t===this.contextGroupId){return this.leaveText.replace("{0}",e)}return this.joinText.replace("{0}",e)}async setupContextPicker(){if(s!==undefined){if(this.bindViews&&s.me.isWindow===true){let t=await s.Window.getCurrent();t.on("view-attached",(async t=>{if(this.contextGroupId!==undefined){setTimeout((async()=>{await this.updateContextGroup(this.contextGroupId,t.viewIdentity,false)}),1e3)}else{let i=s.View.wrapSync(t.viewIdentity);let e=await i.getOptions();if(e.interop!==undefined&&e.interop.currentContextGroup!==undefined){await this.updateContextGroup(e.interop.currentContextGroup,t.viewIdentity)}}}))}let t=await s.me.interop.getContextGroups();t.forEach((t=>{this.availableContextGroups.push({id:t.id,color:t.displayMetadata.color})}));if(this.isQueryStringEnabled){const t=new URLSearchParams(window.location.search);const i=t.get("contextGroupId");if(i!==undefined&&i!==null){await this.updateContextGroup(i)}}if(this.contextGroupId===undefined){let t=await s.me.getOptions();let i;if(t.interop!==undefined&&t.interop.currentContextGroup!==undefined){i=t.interop.currentContextGroup}else if(this.bindSelf===false&&t.customData!==undefined&&t.customData.selectedContextGroup!==undefined){i=t.customData.selectedContextGroup}await this.updateContextGroup(i)}}}componentWillLoad(){this.setupContextPicker().then((t=>{}))}render(){if(this.showContextGroupList){return i("div",{id:"available-context",onMouseLeave:this.hideContextList.bind(this)}," ",this.availableContextGroups.map((t=>i("span",{title:this.getContextGroupTooltip(t.id),class:"fade-in",style:{padding:"0px 5px",color:t.color,cursor:"pointer"},onClick:()=>this.updateContextGroup(t.id)},"⬤"))))}else if(this.contextGroupId===undefined){return i("div",null,this.showListOnClick?i("span",{onClick:this.showContextList.bind(this),title:this.unselectedText,style:{padding:"0px 5px",color:`${this.unselectedColor}`}},"⬤"):i("span",{onMouseEnter:this.showContextList.bind(this),title:this.unselectedText,style:{padding:"0px 5px",color:`${this.unselectedColor}`}},"⬤"))}else{return i("div",{id:"selected-context"},this.showListOnClick?i("span",{onClick:this.showContextList.bind(this),title:this.getContextGroupTooltip(this.contextGroupId,true),style:{padding:"0px 5px",color:`${this.iconColor}`}},"⬤"):i("span",{onMouseEnter:this.showContextList.bind(this),title:this.getContextGroupTooltip(this.contextGroupId,true),style:{padding:"0px 5px",color:`${this.iconColor}`}},"⬤"))}}};n.style=e;export{n as fin_context_group_picker};
//# sourceMappingURL=p-65a85b4d.entry.js.map